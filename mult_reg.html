<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="May Ben-Hamo" />


<title>Multinomial Regression</title>

<script src="mult_reg_files/header-attrs-2.1/header-attrs.js"></script>
<script src="mult_reg_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="mult_reg_files/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="mult_reg_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="mult_reg_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="mult_reg_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="mult_reg_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="mult_reg_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="mult_reg_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="mult_reg_files/navigation-1.1/tabsets.js"></script>
<link href="mult_reg_files/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="mult_reg_files/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Multinomial Regression</h1>
<h4 class="author">May Ben-Hamo</h4>

</div>


<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<div id="iris-dataset" class="section level1">
<h1>Iris dataset</h1>
<p>The Iris flower data set or Fisher’s Iris data set is a multivariate data set introduced by the British statistician, eugenicist, and biologist Ronald Fisher in his 1936 paper The use of multiple measurements in taxonomic problems as an example of linear discriminant analysis.</p>
<p>The data set consists of 50 samples from each of three species of Iris (Iris setosa, Iris virginica and Iris versicolor). Four features were measured from each sample: the length and the width of the sepals and petals, in centimeters. Based on the combination of these four features, Fisher developed a linear discriminant model to distinguish the species from each other.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Sepal.Length"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Sepal.Width"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Petal.Length"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Petal.Width"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Species"],"name":[5],"type":["fctr"],"align":["left"]}],"data":[{"1":"5.1","2":"3.5","3":"1.4","4":"0.2","5":"setosa","_rn_":"1"},{"1":"4.9","2":"3.0","3":"1.4","4":"0.2","5":"setosa","_rn_":"2"},{"1":"4.7","2":"3.2","3":"1.3","4":"0.2","5":"setosa","_rn_":"3"},{"1":"4.6","2":"3.1","3":"1.5","4":"0.2","5":"setosa","_rn_":"4"},{"1":"5.0","2":"3.6","3":"1.4","4":"0.2","5":"setosa","_rn_":"5"},{"1":"5.4","2":"3.9","3":"1.7","4":"0.4","5":"setosa","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>iris_df <span class="ot">=</span> iris <span class="sc">%&gt;%</span> <span class="fu">rename_all</span>(janitor<span class="sc">::</span>make_clean_names)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(iris_df)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    150 obs. of  5 variables:
##  $ sepal_length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
##  $ sepal_width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
##  $ petal_length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
##  $ petal_width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
##  $ species     : Factor w/ 3 levels &quot;setosa&quot;,&quot;versicolor&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(iris_df[,<span class="sc">-</span><span class="dv">5</span>], <span class="at">pch =</span> <span class="dv">21</span>,  </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">bg =</span> <span class="fu">c</span>(<span class="st">&quot;#1b9e77&quot;</span>, <span class="st">&quot;#d95f02&quot;</span>, <span class="st">&quot;#7570b3&quot;</span>)[<span class="fu">unclass</span>(iris_df<span class="sc">$</span>species)])</span></code></pre></div>
<p><img src="mult_reg_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iris_df)</span></code></pre></div>
<pre><code>##   sepal_length    sepal_width     petal_length    petal_width   
##  Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
##  1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  
##  Median :5.800   Median :3.000   Median :4.350   Median :1.300  
##  Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  
##  3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
##  Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  
##        species  
##  setosa    :50  
##  versicolor:50  
##  virginica :50  
##                 
##                 
## </code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>plot_hist_by_species <span class="ot">=</span> <span class="cf">function</span>(col, colname) {</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  iris_df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> species , <span class="at">y =</span> {{col}}, <span class="at">color =</span> species)) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span>  <span class="fu">geom_jitter</span>( <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">position=</span><span class="fu">position_jitter</span>(<span class="at">w=</span><span class="fl">0.1</span>,<span class="at">h=</span><span class="fl">0.1</span>) ) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> colname)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">plot_hist_by_species</span>(sepal_width, <span class="st">&quot;Sepal Width&quot;</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">plot_hist_by_species</span>(sepal_length, <span class="st">&quot;Sepal Length&quot;</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">=</span> <span class="fu">plot_hist_by_species</span>(petal_length, <span class="st">&quot;Petal Length&quot;</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">=</span> <span class="fu">plot_hist_by_species</span>(petal_width, <span class="st">&quot;Petal Width&quot;</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p1, p2, p3, p4)</span></code></pre></div>
<p><img src="mult_reg_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div id="fitting-multinomial-regression" class="section level2">
<h2>Fitting Multinomial Regression</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAM)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>model_1 <span class="ot">=</span> <span class="fu">vglm</span>( species <span class="sc">~</span>  sepal_length  <span class="sc">+</span>  sepal_width    <span class="sc">+</span> petal_length  <span class="sc">+</span>  petal_width, <span class="at">family=</span>multinomial, iris_df)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_1)</span></code></pre></div>
<pre><code>## 
## Call:
## vglm(formula = species ~ sepal_length + sepal_width + petal_length + 
##     petal_width, family = multinomial, data = iris_df)
## 
## Pearson residuals:
##                           Min         1Q     Median        3Q       Max
## log(mu[,1]/mu[,3]) -0.0003873  1.813e-10  6.194e-10 1.252e-06 0.0003643
## log(mu[,2]/mu[,3]) -1.9700374 -3.609e-04 -5.338e-06 4.763e-04 2.5601905
## 
## Coefficients: 
##                 Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept):1     35.490  22666.953      NA       NA  
## (Intercept):2     42.638     25.708   1.659   0.0972 .
## sepal_length:1     9.495   6729.217      NA       NA  
## sepal_length:2     2.465      2.394   1.030   0.3032  
## sepal_width:1     12.300   3143.611      NA       NA  
## sepal_width:2      6.681      4.480   1.491   0.1359  
## petal_length:1   -22.975   4799.227  -0.005   0.9962  
## petal_length:2    -9.429      4.737      NA       NA  
## petal_width:1    -33.843   7583.502      NA       NA  
## petal_width:2    -18.286      9.743      NA       NA  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Names of linear predictors: log(mu[,1]/mu[,3]), log(mu[,2]/mu[,3])
## 
## Residual deviance: 11.8985 on 290 degrees of freedom
## 
## Log-likelihood: -5.9493 on 290 degrees of freedom
## 
## Number of Fisher scoring iterations: 21 
## 
## Warning: Hauck-Donner effect detected in the following estimate(s):
## &#39;(Intercept):1&#39;, &#39;sepal_length:1&#39;, &#39;sepal_width:1&#39;, &#39;petal_length:2&#39;, &#39;petal_width:1&#39;, &#39;petal_width:2&#39;
## 
## 
## Reference group is level  3  of the response</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reference group:virginica</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(iris_df<span class="sc">$</span>species)</span></code></pre></div>
<pre><code>## [1] &quot;setosa&quot;     &quot;versicolor&quot; &quot;virginica&quot;</code></pre>
</div>
<div id="predicting" class="section level2">
<h2>Predicting</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>preds_probs <span class="ot">=</span> <span class="fu">predict</span>(model_1, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">=</span> <span class="fu">apply</span>(preds_probs, <span class="at">MARGIN =</span> <span class="dv">1</span>, which.max)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>species_fun <span class="ot">=</span> <span class="cf">function</span>(level) <span class="fu">return</span>(<span class="fu">levels</span>(iris<span class="sc">$</span>Species)[level])</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>preds_class <span class="ot">=</span> <span class="fu">map_chr</span>(preds, species_fun)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># confusion matrix </span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="st">&quot;Predicted&quot;</span> <span class="ot">=</span> preds_class, <span class="st">&quot;Actual&quot;</span> <span class="ot">=</span> iris_df<span class="sc">$</span>species )</span></code></pre></div>
<pre><code>##             Actual
## Predicted    setosa versicolor virginica
##   setosa         50          0         0
##   versicolor      0         49         1
##   virginica       0          1        49</code></pre>
</div>
</div>
<div id="national-election-study" class="section level1">
<h1>National Election Study</h1>
<p><strong>Description</strong></p>
<p>10 variable subset of the 1996 American National Election Study. Missing values and “don’t know” responses have been listwise deleted. Respondents expressing a voting preference other than Clinton or Dole have been removed (Rosenstone, Kinder, and Miller (1997)).</p>
<p><strong>Format</strong></p>
<p>A data frame with 944 observations on the following 10 variables:</p>
<ul>
<li><code>popul</code> population of respondent’s location in 1000s of people</li>
<li><code>TVnews</code> days in the past week spent watching news on TV</li>
<li><code>selfLR</code> Left-Right self-placement of respondent: an ordered factor with levels extremely liberal, extLib &lt; liberal, Lib &lt; slightly liberal, sliLib &lt; moderate, Mod &lt; slightly conservative, sliCon &lt; conservative, Con &lt; extremely conservative, extCon</li>
<li><code>ClinLR</code> Left-Right placement of Bill Clinton (same scale as selfLR): an ordered factor with levels extLib &lt; Lib &lt; sliLib &lt; Mod &lt; sliCon &lt; Con &lt; extCon newhamp 67</li>
<li><code>DoleLR</code>Left-Right placement of Bob Dole (same scale as selfLR): an ordered factor with levels extLib &lt; Lib &lt; sliLib &lt; Mod &lt; sliCon &lt; Con &lt; extCon</li>
<li><code>PID</code> Party identification: an ordered factor with levels strong Democrat, strDem &lt; weak Democrat, weakDem &lt; independent Democrat, indDem &lt; independent independentindind &lt; indepedent Republican, indRep &lt; waek Republican, weakRep &lt; strong Republican, strRep</li>
<li><code>age</code> Respondent’s age in years</li>
<li><code>educ</code> Respondent’s education: an ordered factor with levels 8 years or less, MS &lt; high school dropout, HSdrop &lt; high school diploma or GED, HS &lt; some College, Coll &lt; Community or junior College degree, CCdeg &lt; BA degree, BAdeg &lt; postgraduate degree, MAdeg <code>income</code> Respondent’s family income: an ordered factor with levels $3Kminus &lt; $3K-$5K &lt; $5K-$7K &lt; $7K-$9K &lt; $9K-$10K &lt; $10K-$11K &lt; $11K-$12K &lt; $12K-$13K &lt; $13K-$14K &lt; $14K-$15K &lt; $15K-$17K &lt; $17K-$20K &lt; $20K-$22K &lt; $22K-$25K &lt; $25K-$30K &lt; $30K-$35K &lt; $35K-$40K &lt; $40K-$45K &lt; $45K-$50K &lt; $50K-$60K &lt; $60K-$75K &lt; $75K-$90K &lt; $90K-$105K &lt; $105Kplus vote Expected vote in 1996 presidential election: a factor with levels Clinton and Dole</li>
</ul>
<p><strong>Source</strong>: Faraway Book:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(faraway)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(nes96)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(nes96)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    944 obs. of  10 variables:
##  $ popul : int  0 190 31 83 640 110 100 31 180 2800 ...
##  $ TVnews: int  7 1 7 4 7 3 7 1 7 0 ...
##  $ selfLR: Ord.factor w/ 7 levels &quot;extLib&quot;&lt;&quot;Lib&quot;&lt;..: 7 3 2 3 5 3 5 5 4 3 ...
##  $ ClinLR: Ord.factor w/ 7 levels &quot;extLib&quot;&lt;&quot;Lib&quot;&lt;..: 1 3 2 4 6 4 6 4 6 3 ...
##  $ DoleLR: Ord.factor w/ 7 levels &quot;extLib&quot;&lt;&quot;Lib&quot;&lt;..: 6 5 6 5 4 6 4 5 3 7 ...
##  $ PID   : Ord.factor w/ 7 levels &quot;strDem&quot;&lt;&quot;weakDem&quot;&lt;..: 7 2 2 2 1 2 2 5 4 1 ...
##  $ age   : int  36 20 24 28 68 21 77 21 31 39 ...
##  $ educ  : Ord.factor w/ 7 levels &quot;MS&quot;&lt;&quot;HSdrop&quot;&lt;..: 3 4 6 6 6 4 4 4 4 3 ...
##  $ income: Ord.factor w/ 24 levels &quot;$3Kminus&quot;&lt;&quot;$3K-$5K&quot;&lt;..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ vote  : Factor w/ 2 levels &quot;Clinton&quot;,&quot;Dole&quot;: 2 1 1 1 1 1 1 1 1 1 ...</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nes96)</span></code></pre></div>
<pre><code>##      popul            TVnews         selfLR       ClinLR       DoleLR   
##  Min.   :   0.0   Min.   :0.000   extLib: 16   extLib:109   extLib: 13  
##  1st Qu.:   1.0   1st Qu.:1.000   Lib   :103   Lib   :317   Lib   : 31  
##  Median :  22.0   Median :3.000   sliLib:147   sliLib:236   sliLib: 43  
##  Mean   : 306.4   Mean   :3.728   Mod   :256   Mod   :160   Mod   : 87  
##  3rd Qu.: 110.0   3rd Qu.:7.000   sliCon:170   sliCon: 67   sliCon:195  
##  Max.   :7300.0   Max.   :7.000   Con   :218   Con   : 36   Con   :460  
##                                   extCon: 34   extCon: 19   extCon:115  
##       PID           age            educ           income         vote    
##  strDem :200   Min.   :19.00   MS    : 13   $60K-$75K:103   Clinton:551  
##  weakDem:180   1st Qu.:34.00   HSdrop: 52   $50K-$60K:100   Dole   :393  
##  indDem :108   Median :44.00   HS    :248   $30K-$35K: 70                
##  indind : 37   Mean   :47.04   Coll  :187   $25K-$30K: 68                
##  indRep : 94   3rd Qu.:58.00   CCdeg : 90   $105Kplus: 68                
##  weakRep:150   Max.   :91.00   BAdeg :227   $35K-$40K: 62                
##  strRep :175                   MAdeg :127   (Other)  :473</code></pre>
<p>The response will be party identification of the respondent: Democrat, Independent or Republican. The original data involved more than three categories; They collapse this to three for simplicity.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>nes96<span class="sc">$</span>PID_new <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  nes96<span class="sc">$</span>PID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;strDem&quot;</span>, <span class="st">&quot;weakDem&quot;</span>) <span class="sc">~</span> <span class="st">&quot;Democrat&quot;</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  nes96<span class="sc">$</span>PID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;indDem&quot;</span>, <span class="st">&quot;indind&quot;</span>, <span class="st">&quot;indRep&quot;</span>) <span class="sc">~</span> <span class="st">&quot;Independent&quot;</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  nes96<span class="sc">$</span>PID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;weakRep&quot;</span>, <span class="st">&quot;strRep&quot;</span>) <span class="sc">~</span> <span class="st">&quot;Republican&quot;</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(nes96<span class="sc">$</span>PID_new)</span></code></pre></div>
<pre><code>## 
##    Democrat Independent  Republican 
##         380         239         325</code></pre>
<p>For simplicity, they consider only the age, education level and income group of the respondents.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unique(nes96$income)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>nes96 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(income) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">sum_inc =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(income, PID_new) <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">pct =</span> n<span class="sc">/</span> sum_inc) <span class="sc">%&gt;%</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>( <span class="at">x=</span> income, <span class="at">y=</span> pct, <span class="at">col =</span> PID_new, <span class="at">group =</span> PID_new)) <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">size =</span><span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span>  <span class="fu">element_text</span>(<span class="at">angle  =</span> <span class="dv">90</span>))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;income&#39;, &#39;PID_new&#39;. You can override using the `.groups` argument.</code></pre>
<p><img src="mult_reg_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>In the book they converted income variable to a numberic variable by taking the midpoint of each range, lets do the same ( we don’t want to estimate too much parameters):</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mid_points <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.5</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="fl">9.5</span>,<span class="fl">10.5</span>,<span class="fl">11.5</span>,<span class="fl">12.5</span>,<span class="fl">13.5</span>,<span class="fl">14.5</span>,<span class="dv">16</span>,<span class="fl">18.5</span>,<span class="dv">21</span>,<span class="fl">23.5</span>,<span class="fl">27.5</span>,<span class="fl">32.5</span>,<span class="fl">37.5</span>,<span class="fl">42.5</span>,<span class="fl">47.5</span>,<span class="dv">55</span>,<span class="fl">67.5</span>,<span class="fl">82.5</span>,<span class="fl">97.5</span>,<span class="dv">115</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>nes96<span class="sc">$</span>numeric_income <span class="ot">&lt;-</span> mid_points[<span class="fu">unclass</span>(nes96<span class="sc">$</span>income)]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nes96<span class="sc">$</span>numeric_income)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    1.50   23.50   37.50   46.58   67.50  115.00</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>nes96 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(educ) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">sum_inc =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(educ, PID_new) <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">pct =</span> n<span class="sc">/</span> sum_inc) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>( <span class="at">x=</span> educ, <span class="at">y=</span> pct, <span class="at">col =</span> PID_new, <span class="at">group =</span> PID_new)) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">size =</span><span class="fl">1.5</span>) </span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;educ&#39;, &#39;PID_new&#39;. You can override using the `.groups` argument.</code></pre>
<p><img src="mult_reg_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>nes96 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>( <span class="fu">aes</span>(  age,  <span class="at">fill =</span> PID_new, <span class="at">color =</span> PID_new)) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..) , <span class="at">bins =</span> <span class="dv">15</span>, <span class="at">alpha =</span> .<span class="dv">8</span>,  <span class="at">color =</span> <span class="st">&#39;white&#39;</span>, <span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>) <span class="sc">+</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span>.<span class="dv">15</span>, <span class="at">fill =</span> <span class="st">&#39;white&#39;</span>)</span></code></pre></div>
<p><img src="mult_reg_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAM)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>model_2 <span class="ot">=</span> <span class="fu">vglm</span>( PID_new <span class="sc">~</span>  age  <span class="sc">+</span>  numeric_income     , <span class="at">family=</span>multinomial, nes96)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_2)</span></code></pre></div>
<pre><code>## 
## Call:
## vglm(formula = PID_new ~ age + numeric_income, family = multinomial, 
##     data = nes96)
## 
## Pearson residuals:
##                       Min      1Q  Median     3Q   Max
## log(mu[,1]/mu[,3]) -1.584 -0.8589 -0.4004 0.9952 2.218
## log(mu[,2]/mu[,3]) -1.094 -0.8435 -0.2753 1.3800 2.016
## 
## Coefficients: 
##                   Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept):1     1.154791   0.273651   4.220 2.44e-05 ***
## (Intercept):2    -0.032387   0.310862  -0.104    0.917    
## age:1            -0.004133   0.004700  -0.879    0.379    
## age:2            -0.003907   0.005396  -0.724    0.469    
## numeric_income:1 -0.017868   0.002667  -6.700 2.09e-11 ***
## numeric_income:2 -0.001744   0.002654  -0.657    0.511    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Names of linear predictors: log(mu[,1]/mu[,3]), log(mu[,2]/mu[,3])
## 
## Residual deviance: 1984.539 on 1882 degrees of freedom
## 
## Log-likelihood: -992.2695 on 1882 degrees of freedom
## 
## Number of Fisher scoring iterations: 4 
## 
## No Hauck-Donner effect found in any of the estimates
## 
## 
## Reference group is level  3  of the response</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ref category - republican</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(<span class="fu">factor</span>(nes96<span class="sc">$</span>PID_new))</span></code></pre></div>
<pre><code>## [1] &quot;Democrat&quot;    &quot;Independent&quot; &quot;Republican&quot;</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(model_2,<span class="fu">data.frame</span>(<span class="at">age =</span> <span class="dv">25</span>, <span class="at">numeric_income=</span><span class="dv">0</span>),<span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>##    Democrat Independent Republican
## 1 0.6037795   0.1852455  0.2109751</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(model_2,<span class="fu">data.frame</span>(<span class="at">age =</span> <span class="dv">25</span>, <span class="at">numeric_income=</span><span class="fu">median</span>(nes96<span class="sc">$</span>numeric_income)),<span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>##    Democrat Independent Republican
## 1 0.4455226   0.2502312  0.3042463</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(model_2,<span class="fu">data.frame</span>(<span class="at">age =</span> <span class="dv">25</span>, <span class="at">numeric_income=</span><span class="fu">mean</span>(nes96<span class="sc">$</span>numeric_income)),<span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>##    Democrat Independent Republican
## 1 0.4076149   0.2650188  0.3273663</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(model_2,<span class="fu">data.frame</span>(<span class="at">age =</span> <span class="dv">50</span>, <span class="at">numeric_income=</span><span class="fu">median</span>(nes96<span class="sc">$</span>numeric_income)),<span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>##    Democrat Independent Republican
## 1 0.4306501   0.2432487  0.3261012</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(model_2,<span class="fu">data.frame</span>(<span class="at">age =</span> <span class="dv">70</span>, <span class="at">numeric_income=</span><span class="fu">median</span>(nes96<span class="sc">$</span>numeric_income)),<span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>##    Democrat Independent Republican
## 1 0.4184309   0.2374178  0.3441513</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>model_3 <span class="ot">=</span> <span class="fu">vglm</span>( PID_new <span class="sc">~</span>  age  <span class="sc">+</span>  numeric_income <span class="sc">+</span> educ    , <span class="at">family=</span>multinomial, nes96)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_3)</span></code></pre></div>
<pre><code>## 
## Call:
## vglm(formula = PID_new ~ age + numeric_income + educ, family = multinomial, 
##     data = nes96)
## 
## Pearson residuals:
##                       Min      1Q  Median    3Q   Max
## log(mu[,1]/mu[,3]) -2.986 -0.8454 -0.3919 1.000 2.267
## log(mu[,2]/mu[,3]) -2.318 -0.7826 -0.2850 1.198 2.283
## 
## Coefficients: 
##                   Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept):1     1.642650   0.331255   4.959 7.09e-07 ***
## (Intercept):2     0.445389   0.372285   1.196   0.2316    
## age:1            -0.008194   0.004903  -1.671   0.0946 .  
## age:2            -0.008041   0.005619  -1.431   0.1524    
## numeric_income:1 -0.017247   0.002882  -5.985 2.17e-09 ***
## numeric_income:2 -0.001008   0.002917  -0.345   0.7297    
## educ.L:1         -1.194114   0.650009  -1.837   0.0662 .  
## educ.L:2         -1.130593   0.713072  -1.586   0.1128    
## educ.Q:1          1.229265   0.603936   2.035   0.0418 *  
## educ.Q:2          1.107555   0.660372   1.677   0.0935 .  
## educ.C:1         -0.154448   0.486465  -0.317   0.7509    
## educ.C:2         -0.042485   0.531864  -0.080   0.9363    
## educ^4:1          0.028269   0.360477   0.078   0.9375    
## educ^4:2         -0.048311   0.397628  -0.121   0.9033    
## educ^5:1          0.122118   0.269581   0.453   0.6506    
## educ^5:2          0.258208   0.296246   0.872   0.3834    
## educ^6:1          0.037413   0.203183   0.184   0.8539    
## educ^6:2          0.191694   0.226809   0.845   0.3980    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Names of linear predictors: log(mu[,1]/mu[,3]), log(mu[,2]/mu[,3])
## 
## Residual deviance: 1968.332 on 1870 degrees of freedom
## 
## Log-likelihood: -984.1663 on 1870 degrees of freedom
## 
## Number of Fisher scoring iterations: 4 
## 
## No Hauck-Donner effect found in any of the estimates
## 
## 
## Reference group is level  3  of the response</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
